<!DOCTYPE html>
<html style="height: 100%">
   <head>
       <meta charset="utf-8">
       <title>LEED in China</title>
       <!--
            作者: Askka
            时间: 2018-08-30
            描述: Echarts地图Demo
        -->
   </head>

   <body style="height: 100%; margin: 0">
       <div id="container" style="height: 100%"></div>
       <div id="container" style="height: 100%"></div>
       <script type="text/javascript" src="https://www.echartsjs.com/gallery/vendors/echarts/echarts.min.js"></script>
       <script type="text/javascript" src="https://www.echartsjs.com/gallery/vendors/echarts-gl/echarts-gl.min.js"></script>
       <script type="text/javascript" src="https://www.echartsjs.com/gallery/vendors/echarts-stat/ecStat.min.js"></script>
       <script type="text/javascript" src="https://www.echartsjs.com/gallery/vendors/echarts/extension/dataTool.min.js"></script>
       <script type="text/javascript" src="https://www.echartsjs.com/gallery/vendors/echarts/map/js/china.js"></script>
       <script type="text/javascript" src="https://www.echartsjs.com/gallery/vendors/echarts/map/js/world.js"></script>
       <script type="text/javascript" src="https://api.map.baidu.com/api?v=2.0&ak=ZUONbpqGBsYGXNIYHicvbAbM"></script>
        <script type="text/javascript" src="https://www.echartsjs.com/gallery/vendors/echarts/extension/bmap.min.js"></script>
       <script type="text/javascript" src="https://www.echartsjs.com/gallery/vendors/simplex.js"></script>
       <script type="text/javascript" src="myjson.js"></script>
              <script type="text/javascript">

       
//初始化
var dom = document.getElementById("container");
var myChart = echarts.init(dom);
var app = {};
var cnDataset = []
var cnDataset2 = []
var tmp = []
option = null;

//myChart.showLoading();
	
// 通过城市名称查询坐标
var convertData = function (data) {
    var res = [];
    for (var i = 0; i < data.length; i++) {
        var geoCoord = geoCoordMap[data[i].name];
        if (geoCoord) {
            res.push({
                name: data[i].name,
                value: geoCoord.concat(data[i].value)
            });
        }
    }
    return res;
    };
            option = {
                // 创建时间条
                baseOption: {
                    timeline: {
                        //采用离散型时间条
                    axisType: 'category',
                    //orient: 'vertical',
                    autoPlay: true,
                    inverse: false,
                    playInterval: 1500,
                    left: 'center',
                    //right: null,
                    top: '90%',
                    //bottom: 'bottom',
                    width: '80%',
                    //height: 'auto',
                    label: {
                        normal: {
                            textStyle: {
                                color: '#999'
                            }
                        },
                        emphasis: {
                            textStyle: {
                                color: '#fff'
                            }
                        }
                    },
                    symbol: 'none',
                    lineStyle: {
                        color: '#555'
                    },
                    checkpointStyle: {
                        color: '#bbb',
                        borderColor: '#777',
                        borderWidth: 2
                    },
                    controlStyle: {
                        showNextBtn: false,
                        showPrevBtn: false,
                        normal: {
                            color: '#666',
                            borderColor: '#666'
                        },
                        emphasis: {
                            color: '#aaa',
                            borderColor: '#aaa'
                        }
                    },
                    data: []
                    },
                    backgroundColor: '#404a59',
                    title: [{// 年度标签文字
                            text: '2005',
                            textAlign: 'center',
                            left: '22%',
                            top: '70%',
                            textStyle: {
                                fontSize: 100,
                                color: 'rgba(255, 255, 255, 0.7)'
                            }
                        }, 
                        // 标题文字
                        {
                        text: '中国LEED认证项目统计',
                        subtext: 'data from USGBC (www.usgbc.org/projects)',
                        sublink: 'https://www.usgbc.org/projects',
                        left: 'center',
                        top: '3%',
                        textStyle: {
                            fontSize: 30,
                            color: 'rgba(255, 255, 255, 0.7)'
                        }
                        },
                        // 注释文字
                        {
                        text: '1. 数据统计截至2018年6月8日；未包含保密(Confidential)申报项目，保密项目共59项；' + '\n' + '2. 我国LEED认证项目总数居世界第二位；',
                        left: '10%',
                        top: '15%',
                        lineHeight: 56,
                        textStyle: {
                            fontWeight: 'normal',
                            fontFamily: 'simhei',
                            fontSize: 13,
                            color: 'rgba(255, 255, 255, 0.7)'
                        }
                        }],
                        // 鼠标移至省份时的显示标签
                        tooltip: {
                            trigger: 'item',
                            showDelay: 0,
                            transitionDuration: 0.2,
                            formatter: function (params) {
                                var value = (params.value + '').split('.');
                                value = value[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g, '$1,');
                                return params.seriesName + '<br/>' + params.name + ': ' + value;
                            }
                        },
                        visualMap: {
                            //orient: 'horizontal',
                            right: '13%',
                            bottom:'35%',                        
                            min: 0,
                            max: 500,
                            inRange: {
                                // 按绿色建立colorbrew，LEED项目数数值越大绿色约亮
                                color: ['#404350', '#00441b', '#006d2c', '#238b45','#41ab5d','#74c476','#a1d99b']
                            },
                            text:['High','Low'],           // 文本，默认为数值文本
                            textStyle: {
                            color: '#fff'},
                            calculable: true
                        },
                        // 工具条
                        toolbox: {
                            show: true,
                            //orient: 'vertical',
                            left: 'left',
                            top: 'top',
                            feature: {
                                dataView: {readOnly: false},
                                restore: {},
                                saveAsImage: {}
                            }
                        },
                        // 初始数据
                        series: [
                            {
                                name: '2005'+'年LEED认证项目数：',
                                type: 'map',
                                roam: false,
                                map: 'china',
                                itemStyle: {
                                    emphasis:{label:{show:true,color:'#fff'}}
                                },
                                // 调整台湾的文本标签
                                textFixed: {
                                台湾: ['50%', '50%']
                                },
                                data: []
                            }
                        ],

                    animationDurationUpdate: 1500,
                    animationEasingUpdate: 'circularIn'
                },
                    options: []
    };

    // debugger
    // 按年份将数据赋值给地图填色
    for (var n = 0; n < cnDataset.timeline.length; n++) {
            option.baseOption.timeline.data.push(cnDataset.timeline[n]);
            option.options.push({
                title: {
                    show: true,
                    'text': cnDataset.timeline[n]
                },
                series: {
                    name: cnDataset.timeline[n] + '年LEED认证项目',
                    type: 'map',
                    map: 'china',
                    data: cnDataset.totalseries[n],
                    }
            });
        }

        myChart.setOption(option);
        });
;
if (option && typeof option === "object") {
    myChart.setOption(option, true);
}

       </script>
   </body>
</html>
